{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///app/auth.config.ts"],"sourcesContent":["import type { NextAuthConfig } from \"next-auth\";\n\nexport const authConfig = {\n    pages: {\n        signIn: \"/login\",\n    },\n    callbacks: {\n        async signIn({ account, profile }) {\n            if (account?.provider === \"line\") {\n                if (!profile?.email) {\n                    return \"/login?error=EmailRequired\";\n                }\n            }\n            return true;\n        },\n        authorized({ auth, request: { nextUrl } }) {\n            const isLoggedIn = !!auth?.user;\n            const isOnDashboard = nextUrl.pathname.startsWith(\"/\");\n            const isOnLogin = nextUrl.pathname.startsWith(\"/login\");\n            const isOnRegister = nextUrl.pathname.startsWith(\"/register\");\n\n            if (isOnDashboard) {\n                // ログイン画面と登録画面は誰でもアクセスOK\n                if (isOnLogin || isOnRegister) return true;\n                // その他のページはログイン必須\n                // if (isLoggedIn) return true;\n                // return false; // Redirect unauthenticated users to login page\n            }\n            return true;\n        },\n    },\n    providers: [], // Providers are configured in auth.ts\n} satisfies NextAuthConfig;\n"],"names":[],"mappings":";;;;AAEO,MAAM,aAAa;IACtB,OAAO;QACH,QAAQ;IACZ;IACA,WAAW;QACP,MAAM,QAAO,EAAE,OAAO,EAAE,OAAO,EAAE;YAC7B,IAAI,SAAS,aAAa,QAAQ;gBAC9B,IAAI,CAAC,SAAS,OAAO;oBACjB,OAAO;gBACX;YACJ;YACA,OAAO;QACX;QACA,YAAW,EAAE,IAAI,EAAE,SAAS,EAAE,OAAO,EAAE,EAAE;YACrC,MAAM,aAAa,CAAC,CAAC,MAAM;YAC3B,MAAM,gBAAgB,QAAQ,QAAQ,CAAC,UAAU,CAAC;YAClD,MAAM,YAAY,QAAQ,QAAQ,CAAC,UAAU,CAAC;YAC9C,MAAM,eAAe,QAAQ,QAAQ,CAAC,UAAU,CAAC;YAEjD,IAAI,eAAe;gBACf,wBAAwB;gBACxB,IAAI,aAAa,cAAc,OAAO;YACtC,iBAAiB;YACjB,+BAA+B;YAC/B,gEAAgE;YACpE;YACA,OAAO;QACX;IACJ;IACA,WAAW,EAAE;AACjB"}},
    {"offset": {"line": 102, "column": 0}, "map": {"version":3,"sources":["file:///app/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\n\nconst globalForPrisma = globalThis as unknown as { prisma: PrismaClient };\n\nexport const prisma = globalForPrisma.prisma || new PrismaClient();\n\nif (process.env.NODE_ENV !== \"production\") globalForPrisma.prisma = prisma;\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,kBAAkB;AAEjB,MAAM,SAAS,gBAAgB,MAAM,IAAI,IAAI,6IAAY;AAEhE,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 115, "column": 0}, "map": {"version":3,"sources":["file:///app/auth.ts"],"sourcesContent":["import NextAuth from \"next-auth\";\nimport Credentials from \"next-auth/providers/credentials\";\nimport { authConfig } from \"./auth.config\";\nimport { PrismaClient } from \"@prisma/client\";\nimport bcrypt from \"bcryptjs\";\n\nimport Line from \"next-auth/providers/line\";\n\nimport { PrismaAdapter } from \"@auth/prisma-adapter\";\nimport { prisma } from \"./src/lib/prisma\";\n\nexport const { handlers, signIn, signOut, auth } = NextAuth({\n    ...authConfig,\n    adapter: PrismaAdapter(prisma),\n    session: { strategy: \"jwt\" },\n    callbacks: {\n        ...authConfig.callbacks,\n        async jwt({ token, user }) {\n            if (user) {\n                token.id = user.id;\n            }\n            return token;\n        },\n        async session({ session, token }) {\n            if (token.id && session.user) {\n                session.user.id = token.id as string;\n            }\n            return session;\n        },\n    },\n    providers: [\n        Line({\n            clientId: process.env.AUTH_LINE_ID,\n            clientSecret: process.env.AUTH_LINE_SECRET,\n            authorization: { params: { scope: \"openid profile email\" } },\n            allowDangerousEmailAccountLinking: true,\n        }),\n        Credentials({\n            credentials: {\n                email: { label: \"Email\", type: \"email\" },\n                password: { label: \"Password\", type: \"password\" },\n            },\n            authorize: async (credentials) => {\n                if (!credentials?.email || !credentials?.password) return null;\n\n                const user = await prisma.user.findUnique({\n                    where: { email: credentials.email as string },\n                });\n\n                if (!user || !user.password) {\n                    return null;\n                }\n\n                const isValid = await bcrypt.compare(\n                    credentials.password as string,\n                    user.password\n                );\n\n                if (isValid) {\n                    return {\n                        id: user.id,\n                        name: user.name,\n                        email: user.email,\n                    };\n                }\n\n                return null;\n            },\n        }),\n    ],\n});\n\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;AAAA;AACA;AAEA;AAEA;AAAA;AAEA;AACA;;;;;;;;AAEO,MAAM,EAAE,QAAQ,EAAE,MAAM,EAAE,OAAO,EAAE,IAAI,EAAE,GAAG,IAAA,kKAAQ,EAAC;IACxD,GAAG,8HAAU;IACb,SAAS,IAAA,uKAAa,EAAC,gIAAM;IAC7B,SAAS;QAAE,UAAU;IAAM;IAC3B,WAAW;QACP,GAAG,8HAAU,CAAC,SAAS;QACvB,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAE;YACrB,IAAI,MAAM;gBACN,MAAM,EAAE,GAAG,KAAK,EAAE;YACtB;YACA,OAAO;QACX;QACA,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC5B,IAAI,MAAM,EAAE,IAAI,QAAQ,IAAI,EAAE;gBAC1B,QAAQ,IAAI,CAAC,EAAE,GAAG,MAAM,EAAE;YAC9B;YACA,OAAO;QACX;IACJ;IACA,WAAW;QACP,IAAA,gMAAI,EAAC;YACD,UAAU,QAAQ,GAAG,CAAC,YAAY;YAClC,cAAc,QAAQ,GAAG,CAAC,gBAAgB;YAC1C,eAAe;gBAAE,QAAQ;oBAAE,OAAO;gBAAuB;YAAE;YAC3D,mCAAmC;QACvC;QACA,IAAA,uMAAW,EAAC;YACR,aAAa;gBACT,OAAO;oBAAE,OAAO;oBAAS,MAAM;gBAAQ;gBACvC,UAAU;oBAAE,OAAO;oBAAY,MAAM;gBAAW;YACpD;YACA,WAAW,OAAO;gBACd,IAAI,CAAC,aAAa,SAAS,CAAC,aAAa,UAAU,OAAO;gBAE1D,MAAM,OAAO,MAAM,gIAAM,CAAC,IAAI,CAAC,UAAU,CAAC;oBACtC,OAAO;wBAAE,OAAO,YAAY,KAAK;oBAAW;gBAChD;gBAEA,IAAI,CAAC,QAAQ,CAAC,KAAK,QAAQ,EAAE;oBACzB,OAAO;gBACX;gBAEA,MAAM,UAAU,MAAM,8IAAM,CAAC,OAAO,CAChC,YAAY,QAAQ,EACpB,KAAK,QAAQ;gBAGjB,IAAI,SAAS;oBACT,OAAO;wBACH,IAAI,KAAK,EAAE;wBACX,MAAM,KAAK,IAAI;wBACf,OAAO,KAAK,KAAK;oBACrB;gBACJ;gBAEA,OAAO;YACX;QACJ;KACH;AACL"}},
    {"offset": {"line": 211, "column": 0}, "map": {"version":3,"sources":["file:///app/app/api/auth/%5B...nextauth%5D/route.ts"],"sourcesContent":["import { handlers } from \"@/auth\"; // @/auth は auth.ts を指します\n\n// GETリクエストとPOSTリクエストをNextAuthに任せます。\nexport const { GET, POST } = handlers;\n"],"names":[],"mappings":";;;;;;AAAA,oLAAmC,yBAAyB;;AAGrD,MAAM,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,kHAAQ"}}]
}