---
trigger: always_on
---


コードの実装または修正案を作成した後、出力する前に必ず以下のcheck.mdを確認して、違反がないか検証を行ってください。違反がある場合は、直ちに修正してください。



1. アーキテクチャ整合性チェック (Critical)
[ ] ディレクトリ構造の厳守: ARCHITECTURE.md で定義されていないディレクトリやファイルを勝手に作成していないか？

[ ] Backendの責務分離: backend/main.py にビジネスロジックやエンドポイント定義を書いていないか？（main.py は初期化と include_router のみに限定されているか？）

[ ] iOSの構造改革: Pages.swift に追記していないか？（単一ファイルの肥大化を避け、FeatureごとのMVVM構成に分割したか？）

[ ] ロジックの所在: 「ルール（法律）はバックエンド、取り締まり（警察）はフロントエンド」の原則を守っているか？（Next.js側に重要なビジネスロジックやバリデーションロジックを漏らしていないか？）

2. コーディング規約と品質チェック
[ ] 逐次コメント: 実装したコードのすべての行に対し、日本語でその行の意図や動作を説明するコメントを記述したか？（教育的観点から必須）

[ ] 時間処理: Date や Time の処理において、UTCではなく JST (Japan Standard Time) または実行環境のロケールを使用しているか？

[ ] ハルシネーション回避: 使用しているライブラリのメソッドや引数は、あなたの学習データまたは検索結果に基づく正確なものか？（推測で書いていないか？）

3. プロセスと技術制約チェック
[ ] Docker環境: 開発環境用の設定において、NODE_ENV=production を誤って使用していないか？（開発時は development であるべき）

[ ] DBマイグレーション: 開発中のスキーマ変更に db push ではなく npx prisma migrate dev を提案しているか？

[ ] Next.jsビルド: next-pwa との兼ね合いで、Turbopackではなく --webpack フラグを使用する設定になっているか？

4. 教育的スタンスの確認
[ ] 思考の開示: いきなりコードを提示せず、「なぜこのディレクトリ構成にするのか」「なぜこのファイルを作成するのか」を ARCHITECTURE.md を引用しながら日本語で説明したか？

[ ] メリット・デメリット: 提案する実装方法の利点だけでなく、潜在的な欠点や考慮すべき点も公平に提示したか？

判定アクション:

もし上記の項目に一つでも違反（チェックボックスがオフ）がある場合、コードを出力せずに、まずその違反内容と修正方針をユーザーに伝えてください。

すべてのチェックをパスした場合のみ、実装コードを提示してください。