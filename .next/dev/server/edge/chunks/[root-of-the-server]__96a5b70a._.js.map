{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/auth.ts"],"sourcesContent":["import NextAuth from \"next-auth\";\nimport Credentials from \"next-auth/providers/credentials\";\n\n// NextAuthの設定\n// ここで「どうやってログインするか」を定義します。\nexport const { handlers, signIn, signOut, auth } = NextAuth({\n    providers: [\n        // Credentialsプロバイダー: IDとパスワードによるログイン\n        Credentials({\n            // ログイン画面の入力項目を定義\n            credentials: {\n                username: { label: \"Username\", type: \"text\" },\n                password: { label: \"Password\", type: \"password\" },\n            },\n            // ログイン処理の実体\n            // ユーザーがボタンを押すと、この関数が実行されます。\n            authorize: async (credentials) => {\n                if (!credentials?.username || !credentials?.password) return null;\n\n                const { PrismaClient } = await import(\"@prisma/client\");\n                const prisma = new PrismaClient();\n                const bcrypt = await import(\"bcryptjs\");\n\n                const user = await prisma.user.findUnique({\n                    where: { phoneNumber: credentials.username as string },\n                });\n\n                if (!user || !user.password) {\n                    return null;\n                }\n\n                const isValid = await bcrypt.compare(\n                    credentials.password as string,\n                    user.password\n                );\n\n                if (isValid) {\n                    return {\n                        id: user.id,\n                        name: user.name,\n                        email: user.email,\n                    };\n                }\n\n                return null;\n            },\n        }),\n    ],\n    // ページの設定\n    pages: {\n        signIn: \"/login\", // カスタムのログイン画面を使う設定\n    },\n});\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;AAAA;;;AAIO,MAAM,EAAE,QAAQ,EAAE,MAAM,EAAE,OAAO,EAAE,IAAI,EAAE,GAAG,IAAA,wKAAQ,EAAC;IACxD,WAAW;QACP,qCAAqC;QACrC,IAAA,6KAAW,EAAC;YACR,iBAAiB;YACjB,aAAa;gBACT,UAAU;oBAAE,OAAO;oBAAY,MAAM;gBAAO;gBAC5C,UAAU;oBAAE,OAAO;oBAAY,MAAM;gBAAW;YACpD;YACA,YAAY;YACZ,4BAA4B;YAC5B,WAAW,OAAO;gBACd,IAAI,CAAC,aAAa,YAAY,CAAC,aAAa,UAAU,OAAO;gBAE7D,MAAM,EAAE,YAAY,EAAE,GAAG;gBACzB,MAAM,SAAS,IAAI;gBACnB,MAAM,SAAS;;;;;gBAEf,MAAM,OAAO,MAAM,OAAO,IAAI,CAAC,UAAU,CAAC;oBACtC,OAAO;wBAAE,aAAa,YAAY,QAAQ;oBAAW;gBACzD;gBAEA,IAAI,CAAC,QAAQ,CAAC,KAAK,QAAQ,EAAE;oBACzB,OAAO;gBACX;gBAEA,MAAM,UAAU,MAAM,OAAO,OAAO,CAChC,YAAY,QAAQ,EACpB,KAAK,QAAQ;gBAGjB,IAAI,SAAS;oBACT,OAAO;wBACH,IAAI,KAAK,EAAE;wBACX,MAAM,KAAK,IAAI;wBACf,OAAO,KAAK,KAAK;oBACrB;gBACJ;gBAEA,OAAO;YACX;QACJ;KACH;IACD,SAAS;IACT,OAAO;QACH,QAAQ;IACZ;AACJ"}},
    {"offset": {"line": 86, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/middleware.ts"],"sourcesContent":["import { auth } from \"@/auth\";\nimport { NextResponse } from \"next/server\";\n\n// ミドルウェア: ページが表示される前に実行される「門番」\nexport default auth((req) => {\n    // ログインしているかどうかチェック\n    const isLoggedIn = !!req.auth;\n\n    // 今いるページのパス\n    const isOnLoginPage = req.nextUrl.pathname.startsWith(\"/login\");\n    const isOnApiRoute = req.nextUrl.pathname.startsWith(\"/api\");\n\n    // APIルートと画像などの静的ファイルはチェックしない（除外）\n    if (isOnApiRoute || req.nextUrl.pathname.includes(\".\")) {\n        return;\n    }\n\n    // ログインページにいる場合\n    if (isOnLoginPage) {\n        // すでにログインしてたらトップページに飛ばす\n        if (isLoggedIn) {\n            return NextResponse.redirect(new URL(\"/\", req.url));\n        }\n        return; // そのまま表示\n    }\n\n    // その他のページ（トップページなど）にいて、ログインしてない場合\n    if (!isLoggedIn) {\n        // ログインページに強制送還\n        return NextResponse.redirect(new URL(\"/login\", req.url));\n    }\n});\n\n// ミドルウェアを適用するパスの設定\nexport const config = {\n    // api, _next/static, _next/image, favicon.ico 以外すべてに適用\n    matcher: [\"/((?!api|_next/static|_next/image|favicon.ico).*)\"],\n};\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AAAA;;;uCAGe,IAAA,oHAAI,EAAC,CAAC;IACjB,mBAAmB;IACnB,MAAM,aAAa,CAAC,CAAC,IAAI,IAAI;IAE7B,YAAY;IACZ,MAAM,gBAAgB,IAAI,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC;IACtD,MAAM,eAAe,IAAI,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC;IAErD,iCAAiC;IACjC,IAAI,gBAAgB,IAAI,OAAO,CAAC,QAAQ,CAAC,QAAQ,CAAC,MAAM;QACpD;IACJ;IAEA,eAAe;IACf,IAAI,eAAe;QACf,wBAAwB;QACxB,IAAI,YAAY;YACZ,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,KAAK,IAAI,GAAG;QACrD;QACA,QAAQ,SAAS;IACrB;IAEA,kCAAkC;IAClC,IAAI,CAAC,YAAY;QACb,eAAe;QACf,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,IAAI,GAAG;IAC1D;AACJ;AAGO,MAAM,SAAS;IAClB,uDAAuD;IACvD,SAAS;QAAC;KAAoD;AAClE"}}]
}