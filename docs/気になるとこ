

なんとなくだけど、あらかじめ入れておくことができる。
全員に共通するDBみたいなものがあるとめっちゃいいよね。

ーー要は、全員のデータベースに一律で追加することができる機能と、そもそもデフォルとで使い方とかを入れておくっていう。


1. 検索精度の劇的向上（Re-ranking）
何ができる？: 検索で見つけた「候補」を、別のAI（Cross-Encoder）でもう一度厳密に採点し直します。
効果: 「キーワードは合ってるけど文脈が違う」ものを排除でき、回答の精度が段違いに良くなります。 Pythonなら sentence-transformers で数行で実装できます。
3. データ分析・グラフ化（Pandas）
何ができる？: ExcelやCSVをアップロードして、「このデータの傾向を教えて」と聞くと、集計してグラフを描画して返すことができます。
効果: RAGだけでなく「データ分析アシスタント」としても使えるようになります。
これユーザ増えたら使えそう

ーーーーー

会話履歴が残るようにしたい。


Webページ (URL) のインポート:
URLを指定して、そのページの記事本文を抽出して保存する機能。
「この記事あとで読む」感覚でAIに覚えさせられます。
YouTube動画のインポート:
YouTubeのURLを指定して、動画の字幕（書き起こし）を抽出して保存する機能。
動画の内容を検索できるようになります。

共有することはできるが、ログインしないと中身を見ることはできないようにもしたい。

（音声は授業ノートのリアルタイム文字起こし&AI分析の30秒制限版。ユーザーが停止ボタンをおすor30秒経ったら勝手に要約作成開始してOK.）
画面半分左側には簡易的なチャット欄設けて、画面半分右上にマイクボタン、下にリアルタイム文字起こしされている文章。その下にAI３行要約っていう感じにしようかなと。
チャット欄では、保存した情報について質問することができる。（2回まで）
文字起こし試すのは1回のみで、それ以上やリタイ場合はログインして無料でやろう！で誘導。
保存ボタンも作って、ログインして保存しよう！的なノリでログインに誘導。
（実際は一時利用者ようのDB作って、一時的にそこに保存して、ログインしたらそのユーザーのDBに移動し、元のDBからは削除。一時的なDBにデータが追加されてから1時間経ったら、音声ファイルなどはPosgre,pinecornから削除。）
チャット制限も2回（検索エンジンはduckduckgo）にして、それ以降はログイン誘導で対応できるようにしたい。
全部制限を強調する必要はなく、ログインすれば無料で使えるよーと、自然に誘導できるようにしてほしい。
スキーマは、GuestSession モデルを追加し、Document にゲスト用の紐付けを持たせル感じで。
同一IPからのリクエストは1時間に3回まで（Bot対策）。

LP構成案。
「サンプルデータ」で疑似体験させる（コスト0円・爆速）
ユーザーの手元のファイルを使わせる前に、「実際にこのアプリで解析した90分授業の結果」 を3パターンほど用意し、ワンクリックで見せます。
LPをスライド式にしてアプローチできる人の幅を広げたいな。

パスワード忘れた人用のページねぇ。

１つのブラウザで２つのアカウントを持つと500エラーになって入れない一方で、アカウント自体は登録されたままになる状態

90分の音声ファイルに関して、おそらく授業ノートの方は90分云々の処理ができているが、音声アップロードの方はできてない。
----
1000人同時利用時のリスク
1時間の動画を10分分割すると「1人あたり6リクエスト」です。 1000人が同時だと 6,000リクエストが一瞬で発生 します。

結論から言うと、今の構成（同期処理）のまま1000人が来たら、Geminiの制限以前にサーバーが落ちます。 （※ただし、個人開発や初期フェーズで1000人同時アクセスはまずあり得ないので、今は過剰な心配です）

将来的な解決策（Happy Problem）
もしサービスが爆発的にヒットして1000人来るようになったら、以下のようにアーキテクチャを進化させます。

非同期処理 (Queue) の導入:
アップロード時: 「受け付けました。後で通知します」とだけ即答。
裏側: [Job Queue] にタスクを積み、ワーカーが順番に（例えば毎分100件ずつ）処理する。
これなら1万人来ても制限には引っかかりません。
クォータ緩和申請:
Google Cloudに「ユーザー増えたから上限上げて」と申請すれば、課金ユーザーなら上限を増やせます。

Schemaに 
duration
 を入れるべき？
100% 入れるべきです！ ご指摘通りです。

現状 (
schema.prisma
): 
Document
 テーブルには 
content
 や summary はありますが、
duration
 (動画の長さ) カラムがありません。

追加するメリット:

UI表示: 一覧画面で「これは90分の講義だな」「15分のメモだな」とひと目で分かる。
統計: 「今月何分使ったか」を正確に集計できる（現状は UserSubscription.monthlyVoiceMinutes に加算していくだけで、元のログが残りにくい）。
提案: 次回、スキーマ変更（マイグレーション）を行うタイミングで、以下のカラムを追加することを強く推奨します。

ユーザーの立場になるとなかなか課金には手を伸ばしにくいと思うので、3dayだけstandardを体験させてもいいかなと思うが、、。
あとは招待された。ユーザーの処理を考えたい。
招待したユーザーは、招待されたユーザーがログインした場合、2週間無料で使うことができる？（4万の貯金あることを考えると、まずは広げること優先で、１ヶ月にしてもうてもいいかも。）
広告費はクソ削減したいので、都立大にばら撒こうかなとおもてる。

リンクに埋め込んで、招待リンクを踏んだ１人が特別なIDを持ってログインして、そのIDが紹介者IDで、そのIDの人に1ヶ月無料クーポンを配るとか、？
スキーマにrefferalモデルが必要になりそう、。

150人くらいを超えると1月無料&紹介で損出るかもらいん。
友達を紹介し続ける限り、君は無料で使い放題だ。1週間無料にしたら、1000人くらいはかかられるんちゃうかな。

仕組み（The Mechanism）入口: 登録時は**「1週間無料トライアル」**（クレカ登録必須・Netflix方式）。※ここが重要です。「完全無料」ではなく「放っておくと来週課金される」状態にすることで、**「課金を回避しなきゃ」という強烈な焦り（緊急性）**を生みます。回避策: 1人紹介するごとに、無料期間が「+2週間（または1ヶ月）」延長される。UI演出:マイページに**「次の請求日：2025/12/10」**と大きく表示。紹介が成功すると、その日付が**「2026/01/10」**にアニメーションで書き換わる演出を入れる。これが「死刑執行が延期された」ような快感となり、中毒性を生みます。2. なぜこれが「爆発」するのか項目旧案（単発1ヶ月無料）新案（サバイバル型）動機「お得だから」紹介する（弱い）**「課金されたくないから」**紹介する（超強い）継続性1回紹介して終わり毎月・期限が迫るたびに紹介し続けるターゲット節約家金はないが友達はいる大学生（ド真ん中）かつて Evernote や Dropbox も、この「紹介でプレミアム機能（容量/期間）を延長」するモデルで初期の爆発的成長を遂げました。学生にとって「月980円の出費回避」は、労働（紹介）に見合う十分な対価です。


招待関連の実装、iosとWeb連動させたいなあ

最終テストで、iosのバックエンドとの連携。課金まわり、DBの更新（ios）

設定が課金まわり一通り完了したら、あとはstoreconnectのsubscriptionの設定(中身の審査ようレビュー写真やスクショで、
アプリの課金がどう使われているのかを説明する。)

4. 開発環境周り

Sandboxテスターの作成

App Store Connectで「Sandboxテスター」のアカウントを作成する

必要があります。実機でデバッグする際、自分のApple IDではなく、

このテスト用アカウントでログインして決済テストを行います（実際

の課金は発生しません）。

初回オファー（トライアル）がある場合、「30日間無料、その後◯◯円」と明確に書く必要あり。
招待関連ロジックに関して、ここが無料になるのは招待なんだ。