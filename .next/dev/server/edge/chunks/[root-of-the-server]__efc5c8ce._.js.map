{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/auth.config.ts"],"sourcesContent":["import type { NextAuthConfig } from \"next-auth\";\n\nexport const authConfig = {\n    pages: {\n        signIn: \"/login\",\n    },\n    callbacks: {\n        authorized({ auth, request: { nextUrl } }) {\n            const isLoggedIn = !!auth?.user;\n            const isOnDashboard = nextUrl.pathname.startsWith(\"/\");\n            const isOnLogin = nextUrl.pathname.startsWith(\"/login\");\n            const isOnRegister = nextUrl.pathname.startsWith(\"/register\");\n\n            if (isOnDashboard) {\n                // ログイン画面と登録画面は誰でもアクセスOK\n                if (isOnLogin || isOnRegister) return true;\n                // その他のページはログイン必須\n                // if (isLoggedIn) return true;\n                // return false; // Redirect unauthenticated users to login page\n            }\n            return true;\n        },\n    },\n    providers: [], // Providers are configured in auth.ts\n} satisfies NextAuthConfig;\n"],"names":[],"mappings":";;;;AAEO,MAAM,aAAa;IACtB,OAAO;QACH,QAAQ;IACZ;IACA,WAAW;QACP,YAAW,EAAE,IAAI,EAAE,SAAS,EAAE,OAAO,EAAE,EAAE;YACrC,MAAM,aAAa,CAAC,CAAC,MAAM;YAC3B,MAAM,gBAAgB,QAAQ,QAAQ,CAAC,UAAU,CAAC;YAClD,MAAM,YAAY,QAAQ,QAAQ,CAAC,UAAU,CAAC;YAC9C,MAAM,eAAe,QAAQ,QAAQ,CAAC,UAAU,CAAC;YAEjD,IAAI,eAAe;gBACf,wBAAwB;gBACxB,IAAI,aAAa,cAAc,OAAO;YACtC,iBAAiB;YACjB,+BAA+B;YAC/B,gEAAgE;YACpE;YACA,OAAO;QACX;IACJ;IACA,WAAW,EAAE;AACjB"}},
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/auth.ts"],"sourcesContent":["import NextAuth from \"next-auth\";\nimport Credentials from \"next-auth/providers/credentials\";\nimport { authConfig } from \"./auth.config\";\nimport { PrismaClient } from \"@prisma/client\";\nimport bcrypt from \"bcryptjs\";\n\nconst prisma = new PrismaClient();\n\nexport const { handlers, signIn, signOut, auth } = NextAuth({\n    ...authConfig,\n    providers: [\n        Credentials({\n            credentials: {\n                username: { label: \"Phone Number\", type: \"text\" },\n                password: { label: \"Password\", type: \"password\" },\n            },\n            authorize: async (credentials) => {\n                if (!credentials?.username || !credentials?.password) return null;\n\n                const user = await prisma.user.findUnique({\n                    where: { phoneNumber: credentials.username as string },\n                });\n\n                if (!user || !user.password) {\n                    return null;\n                }\n\n                const isValid = await bcrypt.compare(\n                    credentials.password as string,\n                    user.password\n                );\n\n                if (isValid) {\n                    return {\n                        id: user.id,\n                        name: user.name,\n                        email: user.email,\n                    };\n                }\n\n                return null;\n            },\n        }),\n    ],\n});\n\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;AAAA;AACA;AACA;;;;;;;;;;;AAGA,MAAM,SAAS,IAAI,qKAAY;AAExB,MAAM,EAAE,QAAQ,EAAE,MAAM,EAAE,OAAO,EAAE,IAAI,EAAE,GAAG,IAAA,wKAAQ,EAAC;IACxD,GAAG,oIAAU;IACb,WAAW;QACP,IAAA,6KAAW,EAAC;YACR,aAAa;gBACT,UAAU;oBAAE,OAAO;oBAAgB,MAAM;gBAAO;gBAChD,UAAU;oBAAE,OAAO;oBAAY,MAAM;gBAAW;YACpD;YACA,WAAW,OAAO;gBACd,IAAI,CAAC,aAAa,YAAY,CAAC,aAAa,UAAU,OAAO;gBAE7D,MAAM,OAAO,MAAM,OAAO,IAAI,CAAC,UAAU,CAAC;oBACtC,OAAO;wBAAE,aAAa,YAAY,QAAQ;oBAAW;gBACzD;gBAEA,IAAI,CAAC,QAAQ,CAAC,KAAK,QAAQ,EAAE;oBACzB,OAAO;gBACX;gBAEA,MAAM,UAAU,MAAM,OAAO,OAAO,CAChC,YAAY,QAAQ,EACpB,KAAK,QAAQ;gBAGjB,IAAI,SAAS;oBACT,OAAO;wBACH,IAAI,KAAK,EAAE;wBACX,MAAM,KAAK,IAAI;wBACf,OAAO,KAAK,KAAK;oBACrB;gBACJ;gBAEA,OAAO;YACX;QACJ;KACH;AACL"}},
    {"offset": {"line": 113, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/middleware.ts"],"sourcesContent":["import { auth } from \"@/auth\";\nimport { NextResponse } from \"next/server\";\n\n// ミドルウェア: ページが表示される前に実行される「門番」\nexport default auth((req) => {\n    // ログインしているかどうかチェック\n    const isLoggedIn = !!req.auth;\n\n    // 今いるページのパス\n    const isOnLoginPage = req.nextUrl.pathname.startsWith(\"/login\");\n    const isOnApiRoute = req.nextUrl.pathname.startsWith(\"/api\");\n\n    // APIルートと画像などの静的ファイルはチェックしない（除外）\n    if (isOnApiRoute || req.nextUrl.pathname.includes(\".\")) {\n        return;\n    }\n\n    // ログインページにいる場合\n    if (isOnLoginPage) {\n        // すでにログインしてたらトップページに飛ばす\n        if (isLoggedIn) {\n            return NextResponse.redirect(new URL(\"/\", req.url));\n        }\n        return; // そのまま表示\n    }\n\n    // その他のページ（トップページなど）にいて、ログインしてない場合\n    if (!isLoggedIn) {\n        // ログインページに強制送還\n        return NextResponse.redirect(new URL(\"/login\", req.url));\n    }\n});\n\n// ミドルウェアを適用するパスの設定\nexport const config = {\n    // api, _next/static, _next/image, favicon.ico 以外すべてに適用\n    matcher: [\"/((?!api|_next/static|_next/image|favicon.ico).*)\"],\n};\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AAAA;;;uCAGe,IAAA,oHAAI,EAAC,CAAC;IACjB,mBAAmB;IACnB,MAAM,aAAa,CAAC,CAAC,IAAI,IAAI;IAE7B,YAAY;IACZ,MAAM,gBAAgB,IAAI,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC;IACtD,MAAM,eAAe,IAAI,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC;IAErD,iCAAiC;IACjC,IAAI,gBAAgB,IAAI,OAAO,CAAC,QAAQ,CAAC,QAAQ,CAAC,MAAM;QACpD;IACJ;IAEA,eAAe;IACf,IAAI,eAAe;QACf,wBAAwB;QACxB,IAAI,YAAY;YACZ,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,KAAK,IAAI,GAAG;QACrD;QACA,QAAQ,SAAS;IACrB;IAEA,kCAAkC;IAClC,IAAI,CAAC,YAAY;QACb,eAAe;QACf,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,IAAI,GAAG;IAC1D;AACJ;AAGO,MAAM,SAAS;IAClB,uDAAuD;IACvD,SAAS;QAAC;KAAoD;AAClE"}}]
}