.cursorrules,.agent,report2025の中身を確認して現状把握お願い


なんとなくだけど、あらかじめ入れておくことができる。
全員に共通するDBみたいなものがあるとめっちゃいいよね。

ーー要は、全員のデータベースに一律で追加することができる機能と、そもそもデフォルとで使い方とかを入れておくっていう。


1. 検索精度の劇的向上（Re-ranking）
何ができる？: 検索で見つけた「候補」を、別のAI（Cross-Encoder）でもう一度厳密に採点し直します。
効果: 「キーワードは合ってるけど文脈が違う」ものを排除でき、回答の精度が段違いに良くなります。 Pythonなら sentence-transformers で数行で実装できます。
3. データ分析・グラフ化（Pandas）
何ができる？: ExcelやCSVをアップロードして、「このデータの傾向を教えて」と聞くと、集計してグラフを描画して返すことができます。
効果: RAGだけでなく「データ分析アシスタント」としても使えるようになります。
これユーザ増えたら使えそう

ーーーーー

会話履歴が残るようにしたい。


Webページ (URL) のインポート:
URLを指定して、そのページの記事本文を抽出して保存する機能。
「この記事あとで読む」感覚でAIに覚えさせられます。
YouTube動画のインポート:
YouTubeのURLを指定して、動画の字幕（書き起こし）を抽出して保存する機能。
動画の内容を検索できるようになります。

共有することはできるが、ログインしないと中身を見ることはできないようにもしたい。

（音声は授業ノートのリアルタイム文字起こし&AI分析の30秒制限版。ユーザーが停止ボタンをおすor30秒経ったら勝手に要約作成開始してOK.）
画面半分左側には簡易的なチャット欄設けて、画面半分右上にマイクボタン、下にリアルタイム文字起こしされている文章。その下にAI３行要約っていう感じにしようかなと。
チャット欄では、保存した情報について質問することができる。（2回まで）
文字起こし試すのは1回のみで、それ以上やリタイ場合はログインして無料でやろう！で誘導。
保存ボタンも作って、ログインして保存しよう！的なノリでログインに誘導。
（実際は一時利用者ようのDB作って、一時的にそこに保存して、ログインしたらそのユーザーのDBに移動し、元のDBからは削除。一時的なDBにデータが追加されてから1時間経ったら、音声ファイルなどはPosgre,pinecornから削除。）
チャット制限も2回（検索エンジンはduckduckgo）にして、それ以降はログイン誘導で対応できるようにしたい。
全部制限を強調する必要はなく、ログインすれば無料で使えるよーと、自然に誘導できるようにしてほしい。
スキーマは、GuestSession モデルを追加し、Document にゲスト用の紐付けを持たせル感じで。
同一IPからのリクエストは1時間に3回まで（Bot対策）。

LP構成案。
「サンプルデータ」で疑似体験させる（コスト0円・爆速）
ユーザーの手元のファイルを使わせる前に、「実際にこのアプリで解析した90分授業の結果」 を3パターンほど用意し、ワンクリックで見せます。
LPをスライド式にしてアプローチできる人の幅を広げたいな。

パスワード忘れた人用のページねぇ。

１つのブラウザで２つのアカウントを持つと500エラーになって入れない一方で、アカウント自体は登録されたままになる状態

90分の音声ファイルに関して、おそらく授業ノートの方は90分云々の処理ができているが、音声アップロードの方はできてない。
----
1000人同時利用時のリスク
1時間の動画を10分分割すると「1人あたり6リクエスト」です。 1000人が同時だと 6,000リクエストが一瞬で発生 します。

結論から言うと、今の構成（同期処理）のまま1000人が来たら、Geminiの制限以前にサーバーが落ちます。 （※ただし、個人開発や初期フェーズで1000人同時アクセスはまずあり得ないので、今は過剰な心配です）

将来的な解決策（Happy Problem）
もしサービスが爆発的にヒットして1000人来るようになったら、以下のようにアーキテクチャを進化させます。

非同期処理 (Queue) の導入:
アップロード時: 「受け付けました。後で通知します」とだけ即答。
裏側: [Job Queue] にタスクを積み、ワーカーが順番に（例えば毎分100件ずつ）処理する。
これなら1万人来ても制限には引っかかりません。
クォータ緩和申請:
Google Cloudに「ユーザー増えたから上限上げて」と申請すれば、課金ユーザーなら上限を増やせます。

Schemaに 
duration
 を入れるべき？
100% 入れるべきです！ ご指摘通りです。

現状 (
schema.prisma
): 
Document
 テーブルには 
content
 や summary はありますが、
duration
 (動画の長さ) カラムがありません。

追加するメリット:

UI表示: 一覧画面で「これは90分の講義だな」「15分のメモだな」とひと目で分かる。
統計: 「今月何分使ったか」を正確に集計できる（現状は UserSubscription.monthlyVoiceMinutes に加算していくだけで、元のログが残りにくい）。
提案: 次回、スキーマ変更（マイグレーション）を行うタイミングで、以下のカラムを追加することを強く推奨します。